{% extends 'layout.html' %}

{% block content %}
<div style="display: flex; gap: 2rem;">
    <!-- Add Member Form -->
    <div class="card" style="flex: 1;">
        <h3>Add Team Member</h3>
        <form action="{{ url_for('add_member') }}" method="POST">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" name="username" id="username" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="full_name">Full Name</label>
                <input type="text" name="full_name" id="full_name" class="form-control">
            </div>
            <div class="form-group">
                <label for="member_id">Member ID</label>
                <input type="text" name="member_id" id="member_id" class="form-control">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" name="password" id="password" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="role">Role</label>
                <select name="role" id="role" class="form-control">
                    <option value="Member">Member</option>
                    <option value="Admin">Admin</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Add Member</button>
        </form>
    </div>

    <!-- Team List -->
    <div class="card" style="flex: 2;">
        <h3>Team Members</h3>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 1px solid #ddd; text-align: left;">
                    <th style="padding: 1rem;">Username</th>
                    <th style="padding: 1rem;">Full Name</th>
                    <th style="padding: 1rem;">Member ID</th>
                    <th style="padding: 1rem;">Role</th>
                    <th style="padding: 1rem;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr style="border-bottom: 1px solid #eee;">
                    <form action="{{ url_for('edit_member', user_id=user.id) }}" method="POST">
                        <td style="padding: 1rem;">
                            <input type="text" name="username" value="{{ user.username }}" class="form-control"
                                style="padding: 0.3rem;" required>
                        </td>
                        <td style="padding: 1rem;">
                            <input type="text" name="full_name" value="{{ user.full_name or '' }}" class="form-control"
                                style="padding: 0.3rem;">
                        </td>
                        <td style="padding: 1rem;">
                            <input type="text" name="member_id" value="{{ user.member_id or '' }}" class="form-control"
                                style="padding: 0.3rem; width: 80px;">
                        </td>
                        <td style="padding: 1rem;">
                            <select name="role" class="form-control" style="padding: 0.3rem;">
                                <option value="Member" {% if user.role=='Member' %}selected{% endif %}>Member</option>
                                <option value="Admin" {% if user.role=='Admin' %}selected{% endif %}>Admin</option>
                            </select>
                        </td>
                        <td style="padding: 1rem; display: flex; gap: 0.5rem;">
                            <button type="submit" class="btn btn-primary"
                                style="padding: 0.3rem 0.6rem; font-size: 0.8rem;">Save</button>
                    </form>
                    {% if user.id != current_user.id %}
                    <form action="{{ url_for('delete_member', user_id=user.id) }}" method="POST"
                        onsubmit="return confirm('Are you sure you want to delete this member?')">
                        <button type="submit" class="btn"
                            style="padding: 0.3rem 0.6rem; font-size: 0.8rem; background-color: #e74c3c; color: white;">Delete</button>
                    </form>
                    {% else %}
                    <span style="color: #999; font-size: 0.8rem;">(You)</span>
                    {% endif %}
                    </td>
                </tr>
                {% endfor %}

            </tbody>
        </table>
    </div>
</div>
{% endblock %}